{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - HarfangLab EDR - 1.1.0",
      "description": "Sample playbooks for \"HarfangLab EDR\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "id": 70,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Fetch Security events",
          "aliasName": null,
          "tag": "#Jira",
          "description": "Fetches events based on input filters",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1692265579,
          "collection": "/api/3/workflow_collections/2d2435e8-8a42-4bd9-9130-ea496b906ad8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/949d8326-d5d8-4f84-b270-dbbb98d44673",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Fetch Security Events",
              "description": null,
              "arguments": {
                "name": "HarfangLab EDR",
                "config": "a0bd6760-7a99-48e2-acec-aaf422c8d707",
                "params": {
                  "param@delay": 0,
                  "param@max_fetch": 10,
                  "param@alert_type": "",
                  "param@first_fetch": 4320,
                  "param@alert_status": "",
                  "param@min_severity": ""
                },
                "version": "1.1.0",
                "connector": "harfanglab-edr",
                "operation": "fetch_security_events",
                "operationTitle": "Fetches Security Events",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "969dc5c8-351f-405e-a60b-2125639788c9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Incidents",
              "description": null,
              "arguments": {
                "route": "aae3e01d-1045-4ce6-9f2e-9d8bda88bd00",
                "title": "Jira: Add Comment",
                "resources": [
                  "incidents"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "949d8326-d5d8-4f84-b270-dbbb98d44673"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Incidents -> Search Endpoints",
              "targetStep": "/api/3/workflow_steps/969dc5c8-351f-405e-a60b-2125639788c9",
              "sourceStep": "/api/3/workflow_steps/949d8326-d5d8-4f84-b270-dbbb98d44673",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "5d98dba5-5e58-498a-86ef-5b8cd6efbfed"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "37e82d8f-2276-49b0-a15a-fa0f661d9e0c",
          "id": 734,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "harfanglab-edr"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Search Multiple IoCs",
          "aliasName": null,
          "tag": "#Jira",
          "description": "Search for multiple IoCs within HarfangLab telemetry",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1691142508,
          "collection": "/api/3/workflow_collections/2d2435e8-8a42-4bd9-9130-ea496b906ad8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/003de50a-09e6-4852-9972-27347b76b55b",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Incidents",
              "description": null,
              "arguments": {
                "route": "e496af1d-30a0-4f5e-99eb-e1ae223629e1",
                "title": "Jira: Add Comment",
                "resources": [
                  "incidents"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "003de50a-09e6-4852-9972-27347b76b55b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Search Multiple IoCs",
              "description": null,
              "arguments": {
                "name": "HarfangLab EDR",
                "config": "a0bd6760-7a99-48e2-acec-aaf422c8d707",
                "params": {
                  "param@iocs": "[\n  {\n    \"type\": \"md5\",\n    \"value\": \"25e49f426d475e01ecc763e3c433fbf4\"\n  }\n]",
                  "param@limit": 10,
                  "param@format": "markdown",
                  "param@search_types": [
                    "searchHash"
                  ]
                },
                "version": "1.1.0",
                "connector": "harfanglab-edr",
                "operation": "search_multiple_iocs_in_telemetry",
                "operationTitle": "Search Multiple IoCs",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "af4daade-ee66-43c8-8087-9cd684747f5c"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Incidents -> Search Endpoints",
              "targetStep": "/api/3/workflow_steps/af4daade-ee66-43c8-8087-9cd684747f5c",
              "sourceStep": "/api/3/workflow_steps/003de50a-09e6-4852-9972-27347b76b55b",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f3ac0636-0da5-4651-b2ee-863e08a5c5eb"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "3f2fdfd1-6109-4b19-9e6b-01673fc8b461",
          "id": 735,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "harfanglab-edr"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Search Endpoints",
          "aliasName": null,
          "tag": "#Jira",
          "description": "Search endpoints with various filters",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1691154631,
          "collection": "/api/3/workflow_collections/2d2435e8-8a42-4bd9-9130-ea496b906ad8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d97420fb-78f2-418a-a245-51e01523b7e1",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Incidents",
              "description": null,
              "arguments": {
                "route": "6d67d5b6-8f5a-4410-ab6a-2ab0162247ab",
                "title": "Jira: Add Comment",
                "resources": [
                  "incidents"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "d97420fb-78f2-418a-a245-51e01523b7e1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Search Endpoints",
              "description": null,
              "arguments": {
                "name": "HarfangLab EDR",
                "config": "a0bd6760-7a99-48e2-acec-aaf422c8d707",
                "params": {
                  "limit": 10,
                  "Offset": 0,
                  "fields": "",
                  "ostype": "",
                  "status": "",
                  "hostname": "",
                  "param@limit": 1,
                  "param@Offset": "",
                  "param@fields": "",
                  "param@offset": "",
                  "param@ostype": "",
                  "param@status": "",
                  "param@hostname": ""
                },
                "version": "1.1.0",
                "connector": "harfanglab-edr",
                "operation": "search_endpoint",
                "operationTitle": "Search Endpoints",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "1e4e0514-5d38-4a90-9063-196cab3a7daa"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Incidents -> Search Endpoints",
              "targetStep": "/api/3/workflow_steps/1e4e0514-5d38-4a90-9063-196cab3a7daa",
              "sourceStep": "/api/3/workflow_steps/d97420fb-78f2-418a-a245-51e01523b7e1",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "ae0c0d91-67c4-4008-8506-e7fa02dab5f2"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "86b86022-4819-4a6b-a3f7-2adbfae93f4d",
          "id": 737,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "harfanglab-edr"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Unisolate Endpoint",
          "aliasName": null,
          "tag": "#Jira",
          "description": "Unisolate endpoint from network",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1691141656,
          "collection": "/api/3/workflow_collections/2d2435e8-8a42-4bd9-9130-ea496b906ad8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/0bed8a46-9eb0-4417-995b-e1bdffdda855",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Incidents",
              "description": null,
              "arguments": {
                "route": "2c1a6314-8891-4c7d-a453-56bb6173eb77",
                "title": "Jira: Add Comment",
                "resources": [
                  "incidents"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "0bed8a46-9eb0-4417-995b-e1bdffdda855"
            },
            {
              "@type": "WorkflowStep",
              "name": "Unisolate Endpoint",
              "description": null,
              "arguments": {
                "name": "HarfangLab EDR",
                "config": "a0bd6760-7a99-48e2-acec-aaf422c8d707",
                "params": {
                  "param@agent_id": "qdqwdqd"
                },
                "version": "1.1.0",
                "connector": "harfanglab-edr",
                "operation": "unisolate_endpoint",
                "operationTitle": "Unisolate an Endpoint",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "96fffc89-5eb2-4f67-a646-07dd48c7691e"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Incidents -> Search Endpoints",
              "targetStep": "/api/3/workflow_steps/96fffc89-5eb2-4f67-a646-07dd48c7691e",
              "sourceStep": "/api/3/workflow_steps/0bed8a46-9eb0-4417-995b-e1bdffdda855",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "1f375243-3377-4aae-97dd-1f260a69970d"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "8788de9a-f2b2-46cb-a5d1-788312d7fbc1",
          "id": 738,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "harfanglab-edr"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Isolate Endpoint",
          "aliasName": null,
          "tag": "#Jira",
          "description": "Isolate endpoint from network",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1691141552,
          "collection": "/api/3/workflow_collections/2d2435e8-8a42-4bd9-9130-ea496b906ad8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/8b13d043-4872-4109-859e-b349037a2941",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Incidents",
              "description": null,
              "arguments": {
                "route": "82751dc9-d26c-49e1-9890-4f64429015a4",
                "title": "Jira: Add Comment",
                "resources": [
                  "incidents"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "8b13d043-4872-4109-859e-b349037a2941"
            },
            {
              "@type": "WorkflowStep",
              "name": "Isolate Endpoint",
              "description": null,
              "arguments": {
                "name": "HarfangLab EDR",
                "config": "a0bd6760-7a99-48e2-acec-aaf422c8d707",
                "params": {
                  "param@agent_id": "qdqdqd"
                },
                "version": "1.1.0",
                "connector": "harfanglab-edr",
                "operation": "isolate_endpoint",
                "operationTitle": "Isolate an Endpoint",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "1616efcb-b76d-48b3-9842-9d145c38d789"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Incidents -> Search Endpoints",
              "targetStep": "/api/3/workflow_steps/1616efcb-b76d-48b3-9842-9d145c38d789",
              "sourceStep": "/api/3/workflow_steps/8b13d043-4872-4109-859e-b349037a2941",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "15129f97-d777-47f2-a208-517407e9fd05"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "959f1e73-8035-4022-b1b7-ede849e7e76e",
          "id": 740,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "harfanglab-edr"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Event By ID",
          "aliasName": null,
          "tag": "#Jira",
          "description": "Fetch Event By ID",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1691136056,
          "collection": "/api/3/workflow_collections/2d2435e8-8a42-4bd9-9130-ea496b906ad8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/8fec3389-c1e6-4c3e-b0a3-bd2fc27d91f0",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Event By ID",
              "description": null,
              "arguments": {
                "name": "HarfangLab EDR",
                "config": "a0bd6760-7a99-48e2-acec-aaf422c8d707",
                "params": {
                  "param@event_id": "lujfl4kBCWge90iwCywS"
                },
                "version": "1.1.0",
                "connector": "harfanglab-edr",
                "operation": "get_event_by_id",
                "operationTitle": "Get Event By ID",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "ac29c11b-2d9e-4465-9fff-6fd19bebf779"
            },
            {
              "@type": "WorkflowStep",
              "name": "Incidents",
              "description": null,
              "arguments": {
                "route": "bfcaf880-7b07-4bce-9613-cea507423e68",
                "title": "Jira: Add Comment",
                "resources": [
                  "incidents"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "8fec3389-c1e6-4c3e-b0a3-bd2fc27d91f0"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Incidents -> Search Endpoints",
              "targetStep": "/api/3/workflow_steps/ac29c11b-2d9e-4465-9fff-6fd19bebf779",
              "sourceStep": "/api/3/workflow_steps/8fec3389-c1e6-4c3e-b0a3-bd2fc27d91f0",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "243fe03a-25d3-4ad0-a94e-86df1609d484"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "9e429eac-5254-4709-a7ed-33168f4103d7",
          "id": 741,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "harfanglab-edr"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> HarfangLabEDR > Fetch",
          "aliasName": null,
          "tag": "#fortinet-fortisiem #fetch #dataingestion",
          "description": "This playbook fetch the open incidents.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1692622130,
          "collection": "/api/3/workflow_collections/2d2435e8-8a42-4bd9-9130-ea496b906ad8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b9a8aafa-d6e9-4705-8cca-2ad980bb741c",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "minutes": "4000",
                "fetch_mode": "By Updates In Last X Minutes",
                "alert_count": 1000,
                "event_count": 5,
                "alert_status": "ACTIVE",
                "min_severity": "Low",
                "records_per_page": "5",
                "HarfanglabEDRMacroName": "HarfanglabEDRLastPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
              },
              "status": null,
              "top": "165",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "6a1ced66-b7d1-43f4-ac04-03c4de86f85f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Incident",
              "description": null,
              "arguments": {
                "name": "harfangLab EDR",
                "config": "14848e3f-bdbb-4a3d-9a54-590face37ce4",
                "params": {
                  "param@delay": 0,
                  "param@max_fetch": "{{vars.records_per_page}}",
                  "param@alert_type": "",
                  "param@first_fetch": "{{vars.last_pull_time}}",
                  "param@alert_status": "{{vars.alert_status}}",
                  "param@min_severity": "{{vars.min_severity}}"
                },
                "version": "1.1.0",
                "connector": "harfanglab-edr",
                "operation": "fetch_security_events",
                "operationTitle": "Fetch Security Events",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "7f72f9db-adb4-4dd3-84d1-b18a527528f0"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.HarfanglabEDRMacroName}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.4",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "34b110e0-e55e-4362-aa13-ce57200978a5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Records Count",
              "description": null,
              "arguments": {
                "records_count": "{{vars.steps.Fetch_Incident.data.1|length}}"
              },
              "status": null,
              "top": "705",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "047fe370-67cc-4be1-abbc-2087d145d68f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Records Returned",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "yes",
                    "step_iri": "/api/3/workflow_steps/5e59fae6-ec74-48b3-90d3-30dd0a723f6b",
                    "condition": "{{ vars.records_count is not none and vars.records_count > 0 }}",
                    "step_name": "Return Results"
                  },
                  {
                    "option": "no",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/42a35c17-ae9f-4dab-805f-223c565ca2bc",
                    "step_name": "Returns No Results"
                  }
                ],
                "step_variables": []
              },
              "status": null,
              "top": "840",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "89ddd2cd-705e-417a-ba7b-106a669c6623"
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Results",
              "description": null,
              "arguments": {
                "data": "{{vars.steps.Fetch_Incident.data.1}}",
                "event_count": "{{vars.records_count}}",
                "current_time": "{{vars.curr_timestamp}}",
                "HarfanglabEDRMacroName": "{{vars.HarfanglabEDRMacroName}}"
              },
              "status": null,
              "top": "975",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "5e59fae6-ec74-48b3-90d3-30dd0a723f6b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Returns No Results",
              "description": null,
              "arguments": {
                "data": "",
                "event_count": "0",
                "current_time": "{{vars.curr_timestamp}}",
                "HarfanglabEDRMacroName": "{{vars.HarfanglabEDRMacroName}}"
              },
              "status": null,
              "top": "975",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "42a35c17-ae9f-4dab-805f-223c565ca2bc"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Time Configuration",
              "description": null,
              "arguments": {
                "macro_name": "{{vars.HarfanglabEDRMacroName}}",
                "curr_timestamp": "{{ arrow.utcnow().format('YYYY-MM-DDTHH:mm:ss.ssss')\n}}Z",
                "last_pull_time": "{% if vars.steps.Get_Macro_Value.data['hydra:member'] | length > 0 %}    {% if vars.request.env_setup %}        {% if not vars.minutes or vars.minutes == '' %}            0        {% else %}            {{vars.minutes}}         {% endif %}    {% else %}        {{ ((arrow.now() - arrow.get(vars.steps.Get_Macro_Value.data['hydra:member'][0]['value'])).seconds / 60) | int }}    {% endif %}{% else %}    {% if not vars.minutes or vars.minutes == '' %}        0    {% else %}        {{vars.minutes}}    {% endif %}{% endif %}"
              },
              "status": null,
              "top": "435",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "016c7180-1abc-4d31-8362-3db32d8b8814"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "useMockOutput": "False",
                  "_configuration_schema": "[\n  {\n    \"title\": \"Pull Alerts Created In Last X Minutes\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"type\": \"text\",\n    \"name\": \"minutes\",\n    \"tooltip\": \"Fetch Alerts from last X minutes. e.g 5\",\n    \"value\": 30\n  },\n  {\n    \"title\": \"Maximum Alerts To Pull\",\n    \"name\": \"alert_count\",\n    \"type\": \"integer\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 1000,\n    \"tooltip\": \"The Maximum number of Alerts to be fetched from HarfanglabEDR\"\n  },\n  {\n    \"title\": \"Alert Status Name\",\n    \"type\": \"multiselect\",\n    \"name\": \"alert_status_name\",\n    \"options\": [\n      \"Ongoing\",\n      \"Rejected\",\n      \"Pending\"\n    ],\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": [\n      \"Ongoing\"\n    ]\n  }\n]"
                }
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "b9a8aafa-d6e9-4705-8cca-2ad980bb741c"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/34b110e0-e55e-4362-aa13-ce57200978a5",
              "sourceStep": "/api/3/workflow_steps/6a1ced66-b7d1-43f4-ac04-03c4de86f85f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "b2df0d1c-7967-4bbd-af96-7ab992cffacd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Incident -> Get Records Count",
              "targetStep": "/api/3/workflow_steps/047fe370-67cc-4be1-abbc-2087d145d68f",
              "sourceStep": "/api/3/workflow_steps/7f72f9db-adb4-4dd3-84d1-b18a527528f0",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "910c6a3c-b798-4bad-839d-463005bceb9e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Set Time Configuration",
              "targetStep": "/api/3/workflow_steps/016c7180-1abc-4d31-8362-3db32d8b8814",
              "sourceStep": "/api/3/workflow_steps/34b110e0-e55e-4362-aa13-ce57200978a5",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "123adba7-8fef-49f1-9981-48ba1a6ebc46"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Records Count -> Records Returned",
              "targetStep": "/api/3/workflow_steps/89ddd2cd-705e-417a-ba7b-106a669c6623",
              "sourceStep": "/api/3/workflow_steps/047fe370-67cc-4be1-abbc-2087d145d68f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f2ec8e85-0eb2-4cc4-ad13-3af6df43d2c2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Records Returned -> Return Results",
              "targetStep": "/api/3/workflow_steps/5e59fae6-ec74-48b3-90d3-30dd0a723f6b",
              "sourceStep": "/api/3/workflow_steps/89ddd2cd-705e-417a-ba7b-106a669c6623",
              "label": "yes",
              "isExecuted": false,
              "group": null,
              "uuid": "f866b248-a835-4b5e-9d47-90f974843b9d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Records Returned -> Returns No Results",
              "targetStep": "/api/3/workflow_steps/42a35c17-ae9f-4dab-805f-223c565ca2bc",
              "sourceStep": "/api/3/workflow_steps/89ddd2cd-705e-417a-ba7b-106a669c6623",
              "label": "no",
              "isExecuted": false,
              "group": null,
              "uuid": "0acd25e1-80c5-40bc-b9ed-58c162ab78cc"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Time Configuration -> Fetch Incident",
              "targetStep": "/api/3/workflow_steps/7f72f9db-adb4-4dd3-84d1-b18a527528f0",
              "sourceStep": "/api/3/workflow_steps/016c7180-1abc-4d31-8362-3db32d8b8814",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "bcdd98d3-54c4-4a35-9029-b36eca620c3c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/6a1ced66-b7d1-43f4-ac04-03c4de86f85f",
              "sourceStep": "/api/3/workflow_steps/b9a8aafa-d6e9-4705-8cca-2ad980bb741c",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "718d93a2-c117-447e-a151-272ca4531d80"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "c7e57ea7-47f2-4942-bcab-293bbe35b74e",
          "id": 746,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fetch",
            "harfanglab-edr"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HarfangLabEDR> Ingest",
          "aliasName": null,
          "tag": "#fortinet-fortisiem #ingest #dataingestion #create",
          "description": "This playbook demonstrate the list incident operation.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1692622054,
          "collection": "/api/3/workflow_collections/2d2435e8-8a42-4bd9-9130-ea496b906ad8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/87b1d2b1-aac1-48d3-b9f7-ebbfc03eed0c",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "event_count": "{{ vars.result.event_count }}",
                "alerts_state_map": "{}",
                "alerts_status_map": "{}",
                "alerts_severity_map": "{'MINIMAL': {{'Severity'| picklist('Minimal') }}, 'LOW': {{'Severity'| picklist('Low') }}, 'MEDIUM': {{'Severity'| picklist('Medium') }}, 'HIGH': {{'Severity'| picklist('High') }}, 'CRITICAL': {{'Severity'| picklist('Critical') }}}",
                "incident_source_data": "{{ vars.result.data }}",
                "HarfanglabEDRMacroName": "{{vars.result.HarfanglabEDRMacroName}}"
              },
              "status": null,
              "top": "306",
              "left": "413",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "c4a89789-7c10-4c02-bafa-a0d6af838a03"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "when": "{{vars.incident_source_data | length > 0}}",
                "for_each": {
                  "item": "{{vars.incident_source_data}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "name": "{{vars.item.name}}",
                  "type": "/api/3/picklists/574a6ee2-7265-4701-815e-cff83b053bce",
                  "state": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                  "source": "HarfangLab EDR",
                  "status": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                  "severity": "{% if vars.item.severity == 1 %}{{\"Severity\" | picklist(\"Minimal\", \"@id\")}}{%elif vars.item.severity == 2 %}{{\"Severity\" | picklist(\"Low\", \"@id\")}}{%elif vars.item.severity == 3 %}{{\"Severity\" | picklist(\"Medium\", \"@id\")}}{%elif vars.item.severity == 4 %}{{\"Severity\" | picklist(\"High\", \"@id\")}}{%elif vars.item.severity == 5 %}{{\"Severity\" | picklist(\"Critical\", \"@id\")}}{%endif%}",
                  "sourceId": "{{vars.item.alert.id}}",
                  "userName": "{{vars.item.alert.process.username}}",
                  "__replace": "true",
                  "epochTime": "{{arrow.get(vars.item.occurred).to(\"UTC\").int_timestamp}}",
                  "eventTime": "{{vars.item.occurred}}",
                  "sourcedata": "{{vars.item | toJSON}}",
                  "description": "# Alert Message: {{vars.item.alert.msg}}\n\n### Source: {{vars.item.alert.agent.hostname or \"N/A\"}}\n### Process Name: {{vars.item.alert.process.process_name or \"N/A\"}}",
                  "targetAsset": "{{vars.item.alert.agent.hostname}}",
                  "ackSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "respSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "priorityWeight": 1,
                  "escalatedtoincident": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                  "resolvedAutomatedly": false,
                  "alertRemainingAckSLA": 0
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/alerts",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "440",
              "left": "620",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "44a7bd77-8be6-4a31-8c88-1a2029882605"
            },
            {
              "@type": "WorkflowStep",
              "name": "List Incident",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/c7e57ea7-47f2-4942-bcab-293bbe35b74e"
              },
              "status": null,
              "top": "166",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "5919f189-c71f-466f-88cc-b5c2349258b7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "eec15844-9575-4082-aa33-393305c19133",
                "title": "HarfanglabEDR > Ingest",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "showToasterMessage": {
                  "visible": false,
                  "messageVisible": true
                },
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "87b1d2b1-aac1-48d3-b9f7-ebbfc03eed0c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Last Alert Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.HarfanglabEDRMacroName}}",
                  "value": "{{vars.steps.List_Incident.current_time}}"
                },
                "version": "3.2.4",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Update Global Variables",
                "step_variables": []
              },
              "status": null,
              "top": "560",
              "left": "820",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "231c7211-7e2a-4f1d-b490-5d764fa0414c"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Create Record",
              "targetStep": "/api/3/workflow_steps/44a7bd77-8be6-4a31-8c88-1a2029882605",
              "sourceStep": "/api/3/workflow_steps/c4a89789-7c10-4c02-bafa-a0d6af838a03",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "967f96f1-17f0-4cb1-adbb-15d7487b54c2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Record -> Update Last Alert Pull Time",
              "targetStep": "/api/3/workflow_steps/231c7211-7e2a-4f1d-b490-5d764fa0414c",
              "sourceStep": "/api/3/workflow_steps/44a7bd77-8be6-4a31-8c88-1a2029882605",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "e4afdae7-3361-4cbf-acdd-b6ae3f281631"
            },
            {
              "@type": "WorkflowRoute",
              "name": "List Incident -> Config",
              "targetStep": "/api/3/workflow_steps/c4a89789-7c10-4c02-bafa-a0d6af838a03",
              "sourceStep": "/api/3/workflow_steps/5919f189-c71f-466f-88cc-b5c2349258b7",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "0e40fe98-fbf5-4857-87a4-f0acf6e04780"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> List Incident",
              "targetStep": "/api/3/workflow_steps/5919f189-c71f-466f-88cc-b5c2349258b7",
              "sourceStep": "/api/3/workflow_steps/87b1d2b1-aac1-48d3-b9f7-ebbfc03eed0c",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "27c6113f-f3c4-47c5-be54-89850b97c4c6"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "cb096d15-d9b4-4edf-a9f1-b05e68066db5",
          "id": 745,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "create",
            "ingest",
            "harfanglab-edr"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Change Security Event Status",
          "aliasName": null,
          "tag": "#Jira",
          "description": "Change Security Event Status",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1691142321,
          "collection": "/api/3/workflow_collections/2d2435e8-8a42-4bd9-9130-ea496b906ad8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/71561fa8-4303-4951-9a95-9a349ebfcaaa",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Change Security Event Status",
              "description": null,
              "arguments": {
                "name": "HarfangLab EDR",
                "config": "a0bd6760-7a99-48e2-acec-aaf422c8d707",
                "params": {
                  "param@status": "New",
                  "param@security_event_id": "lujfl4kBCWge90iwCywS"
                },
                "version": "1.1.0",
                "connector": "harfanglab-edr",
                "operation": "change_security_event_status",
                "operationTitle": "Change Security Event Status",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "0c21e72c-c951-41d1-9e8c-8cf29e9d55ec"
            },
            {
              "@type": "WorkflowStep",
              "name": "Incidents",
              "description": null,
              "arguments": {
                "route": "8a14d2db-f390-4808-81b4-74b244a1d218",
                "title": "Jira: Add Comment",
                "resources": [
                  "incidents"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "71561fa8-4303-4951-9a95-9a349ebfcaaa"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Incidents -> Search Endpoints",
              "targetStep": "/api/3/workflow_steps/0c21e72c-c951-41d1-9e8c-8cf29e9d55ec",
              "sourceStep": "/api/3/workflow_steps/71561fa8-4303-4951-9a95-9a349ebfcaaa",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "748ba0a4-f849-4fb4-9076-ca788183290c"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "e5b591ce-ee64-4c20-b1dc-dcc861471b58",
          "id": 742,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "harfanglab-edr"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "harfanglab-edr",
    "dataingestion",
    "fetch",
    "create",
    "ingest"
  ]
}